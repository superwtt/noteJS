(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{247:function(t,e,r){"use strict";r.r(e);var a=r(6),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h3",{attrs:{id:"render阶段流程概览"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#render阶段流程概览"}},[t._v("#")]),t._v(" render阶段流程概览")]),t._v(" "),r("p",[t._v('render阶段的使用遍历来实现可中断的递归，递归分为"递"阶段和"归"阶段，其中“递”阶段会执行'),r("code",[t._v("beginWork")]),t._v('，"归"阶段会执行'),r("code",[t._v("completeWork")]),t._v("。")]),t._v(" "),r("p",[r("code",{staticStyle:{color:"red"}},[t._v("最终"),r("code",[t._v("beginWork")]),t._v("阶段会生成一棵完整的"),r("code",[t._v("Fiber树")]),t._v("；"),r("code",[t._v("completeWork")]),t._v("阶段会生成一棵完整的"),r("code",[t._v("DOM树")]),t._v("，等待commit阶段渲染到页面上.")])]),t._v(" "),r("ol",[r("li",[t._v('"递阶段"')])]),t._v(" "),r("ul",[r("li",[t._v('"递阶段"会调用'),r("code",[t._v("beginWork")]),t._v("方法来生成"),r("code",[t._v("Fiber")]),t._v("节点")]),t._v(" "),r("li",[t._v("首先从"),r("code",[t._v("RootFiber")]),t._v("节点开始向下深度优先遍历，为遍历到的每个Fiber节点调用"),r("code",[t._v("beginWork")])]),t._v(" "),r("li",[r("code",[t._v("beginWork")]),t._v("会根据传入的Fiber节点创建子Fiber节点，并将这两个Fiber节点连接起来")])]),t._v(" "),r("ol",{attrs:{start:"2"}},[r("li",[t._v('"归阶段"')])]),t._v(" "),r("ul",[r("li",[t._v('"归阶段"会调用'),r("code",[t._v("completeWork")]),t._v("处理Fiber节点")]),t._v(" "),r("li",[t._v("当某个Fiber节点执行完"),r("code",[t._v("completeWork")]),t._v('，如果其存在兄弟Fiber节点，会进入兄弟Fiber节点的"递阶段"')]),t._v(" "),r("li",[t._v('如果不存在兄弟节点，会进入父级Fiber的"归"阶段')])]),t._v(" "),r("p",[t._v('"递"和"归" 阶段会交错执行直到"归"到'),r("code",[t._v("RootFiber")]),t._v("，至此，render阶段的工作就结束了")]),t._v(" "),r("hr"),t._v(" "),r("h3",{attrs:{id:"举例"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#举例"}},[t._v("#")]),t._v(" 举例")]),t._v(" "),r("div",{staticClass:"language-javascript extra-class"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("App")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      i am\n      "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("span"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("KaSong"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("span"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nReactDOM"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("App "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" document"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),r("p",[t._v("对应的Fiber树结构：")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://raw.githubusercontent.com/superwtt/MyFileRepository/main/image/React/fiber.png",alt:""}})]),t._v(" "),r("p",[t._v("render阶段依次会执行：")]),t._v(" "),r("div",{staticClass:"language-javascript extra-class"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[t._v("rootFiber beginWork\nApp fiber beginWork\ndiv fiber beginWork\ni am fiber beginWork\ni am fiber completeWork\nspan fiber beginWork\nspan fiber completeWork\ndiv fiber completeWork\nApp fiber completeWork\nrootFiber completeWork\n")])])])])}),[],!1,null,null,null);e.default=s.exports}}]);